From 2d546b97fab37afba9dc5c1f80f84a18e58e8417 Mon Sep 17 00:00:00 2001
From: Samuel Holland <samuel@sholland.org>
Date: Sat, 25 Feb 2017 23:51:58 -0600
Subject: [PATCH] Link libgcc_s over libunwind on musl

---
 src/libunwind/build.rs | 8 ++------
 1 file changed, 2 insertions(+), 6 deletions(-)

diff --git a/src/libunwind/build.rs b/src/libunwind/build.rs
index be9aa6c5d40b..2a3e156e3a1c 100644
--- a/src/libunwind/build.rs
+++ b/src/libunwind/build.rs
@@ -14,12 +14,8 @@ fn main() {
     println!("cargo:rerun-if-changed=build.rs");
     let target = env::var("TARGET").expect("TARGET was not set");
 
-    if target.contains("linux") {
-        if target.contains("musl") && !target.contains("mips") {
-            println!("cargo:rustc-link-lib=static=unwind");
-        } else if !target.contains("android") {
-            println!("cargo:rustc-link-lib=gcc_s");
-        }
+    if target.contains("linux") && !target.contains("android") {
+        println!("cargo:rustc-link-lib=gcc_s");
     } else if target.contains("freebsd") {
         println!("cargo:rustc-link-lib=gcc_s");
     } else if target.contains("rumprun") {
